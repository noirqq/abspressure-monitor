# Система Мониторинга Атмосферного Давления для Home Assistant

Эта система предназначена для отслеживания изменений атмосферного давления с использованием Home Assistant. Она позволяет получать по запросу через Telegram анализ трендов давления, а также автоматически получать уведомления при резких изменениях.

## Функционал

*   **Ручной анализ по команде**: Отправьте команду `/trend <часы>` вашему Telegram боту (например, `/trend 3`), чтобы получить анализ изменения давления за указанное количество часов.
*   **Автоматические уведомления**: Система периодически проверяет скорость изменения давления. Если скорость превышает установленный вами порог, вы получите уведомление в Telegram.
*   **Настраиваемые пороги и окна**: Через интерфейс Home Assistant (с помощью Input Helpers) вы можете настроить:
    *   Порог срабатывания для автоматических уведомлений (гПа/час).
    *   Временное окно, за которое анализируются данные для автоматической проверки (в часах).
*   **Кулдаун уведомлений**: Чтобы избежать спама, автоматические уведомления имеют настраиваемый период "тишины" после срабатывания.
*   **Простой запрос текущего давления**: Команда `/pressure` для быстрого получения текущего значения.

## Требования

Для работы этой системы вам понадобятся следующие компоненты и интеграцииХорошо, давайте представим, что мы создаем `README.md` для вашего GitHub-проекта. Этот файл будет основным описанием вашего проекта.

---

# Home Assistant: Мониторинг Атмосферного Давления с Уведомлениями в Telegram

Эта система для Home Assistant позволяет отслеживать изменения атмосферного давления, получать детальный анализ по запросу через Telegram и получать автоматические уведомления при резких колебаниях.

## Функционал

*   **Ручной анализ по команде `/trend`**: Отправьте команду `/trend <часы>` вашему Telegram-боту (например, `/trend 3`), чтобы получить отчет об изменении давления за указанное количество часов. Отчет включает начальное, конечное, минимальное, максимальное, среднее давление Home Assistant:

*   **Home Assistant**: Основная платформа.
*   **InfluxDB**:
    *   **Дополнение InfluxDB**: Для хранения исторических данных.
    *   **Интеграция InfluxDB**: Для связи HA с базой данных и предоставления сервиса `influxdb.query`.
*   **Pyscript Python scripting**:
    *   **Интеграция Pyscript**: Для выполнения Python-кода (рекомендуется установка через HACS).
*   **Telegram**:
    *   **Интеграция Telegram bot**: Для приема команд.
    *   **Платформа Notify (Telegram)**: Для отправки сообщений.
*   **Сенсор атмосферного давления**: Например, от интеграции `OpenWeatherMap` (предоставляет `sensor.openweathermap_ и среднюю скорость изменения.
*   **Автоматические уведомления**: Система периодически проверяет скорость изменения давленияpressure`).
*   **Input Number** (встроенная интеграция): Для настройки порогов и окон.
*   **Input Datetime** (встроенная интеграция): Для отслеживания времени последнего уведомления.
*   **HACS** (Home Assistant Community Store): Рекомендуется для простой установки Pyscript.

## Установка и Настройка

###. Если скорость превышает установленный вами порог (например, 5 гПа/час), вы получите уведомление в Telegram.
*   **Настраиваемые пороги и кулдаун**: Порог срабатывания для автоматических уведомлений, окно анализа и время "кулдауна" (чтобы не получать уведомления слишком часто) настраиваются через интерфейХорошо, давайте представим, что мы создаем структуру и основное содержимое 1. Файлы конфигурации Home Assistant

**`configuration.yaml`:**

Добавьте или убедитесь в наличии следующих секций. **Замените `YOUR_TELEGRAM_API_KEY` и `YOUR_CHATс Home Assistant.
*   **Форматированные сообщения**: Уведомления и отчеты в Telegram используют Markdown для лучшей читаемости.

## Требования

Для работы этой системы необходимы следующие компоненты Home Assistant:

**Дополнения (Add-ons):**
*   **InfluxDB**: Для хранения исторических данных о давлении.
 для вашего GitHub-репозитория проекта "Home Assistant Pressure Monitor".

**Имя репозитория (предположим):** `ha-pressure-monitor`

**Структура папок и файлов в репозитории:**

_ID` вашими значениями.**

```yaml
# Loads default set of integrations. Do not remove.
default_config:

pyscript:
  allow_all_imports: true
  hass_is_global:*   **Studio Code Server** или **File editor**: Для удобного редактирования конфигурационных файлов и Pyscript-```
ha-pressure-monitor/
├── pyscript/
│   └── pressure_monitor.py   # Ваш true
  
logger:
  default: info
  logs:
    custom_components.pyscript: info
    # Раскомментируйте для отладки InfluxDB, если сервис influxdb.query не работает
    кода.

**Интеграции:**
*   **HACS (Home Assistant Community Store)**: Рекомендуется для простой установки Pyscript.
*   **Pyscript Python scripting**: Для выполнения основной логики системы основной Pyscript файл
├── .gitignore                # (Опционально, но рекомендуется)
├── LICENSE                   # homeassistant.components.influxdb: debug 

# Настройка Telegram бота
telegram_bot:
  - platform: polling
    api_key: YOUR_TELEGRAM_API_KEY 
    allowed_chat_ids.
*   **InfluxDB (интеграция)**: Для связи Home Assistant с базой данных InfluxDB и выполнения запросов.
*   **Telegram bot**: Для приема команд и отправки сообщений через Telegram.
*# (Опционально, но рекомендуется для публичных проектов)
└── README.md                 # Главный описательный файл проекта
